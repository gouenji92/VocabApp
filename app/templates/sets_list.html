<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>Danh s√°ch b·ªô t·ª´ - VocabApp</title>
  <link rel="stylesheet" href="/static/base.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f0f2f5;
      min-height: 100vh;
    }

    /* Header styles centralized in /static/base.css */

    /* Main Content */
    .container { 
      max-width: 1200px; 
      margin: 20px auto; 
      padding: 0 20px;
    }

    .page-header {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .page-header h1 {
      font-size: 2em;
      color: #050505;
      margin-bottom: 8px;
    }

    .page-header p {
      color: #65676b;
      font-size: 1em;
    }

    .search-box {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .search-box input { 
      width: 100%;
      padding: 12px 16px;
      border: 1px solid #ddd;
      border-radius: 25px;
      background: #f0f2f5;
      font-size: 0.95em;
      outline: none;
      transition: all 0.3s;
    }

    .search-box input:focus {
      background: white;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    /* Tabs Navigation */
    .tabs-nav {
      background: white;
      border-radius: 12px;
      padding: 8px;
      margin-bottom: 20px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
      display: flex;
      gap: 8px;
    }

    .tab-btn {
      flex: 1;
      padding: 12px 24px;
      background: transparent;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.95em;
      color: #65676b;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .tab-btn:hover {
      background: #f0f2f5;
    }

    .tab-btn.active {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .tab-btn img {
      width: 20px;
      height: 20px;
      filter: grayscale(1) opacity(0.6);
    }

    .tab-btn.active img {
      filter: brightness(0) invert(1);
    }

    .actions { 
      display: flex; 
      gap: 12px; 
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .btn {
      padding: 12px 24px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-browse {
      background: linear-gradient(135deg, #f093fb, #f5576c);
      box-shadow: 0 2px 8px rgba(240, 147, 251, 0.3);
    }

    .btn-browse:hover {
      box-shadow: 0 4px 12px rgba(240, 147, 251, 0.4);
    }

    .sets-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
      gap: 16px;
      margin-bottom: 40px;
    }

    .set-item { 
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
      transition: all 0.3s;
      display: flex;
      flex-direction: column;
    }

    .set-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    }

    .set-item h3 { 
      font-size: 1.3em;
      color: #050505;
      margin: 0 0 8px 0;
    }

    .set-description {
      color: #65676b;
      margin: 0 0 12px 0;
      line-height: 1.5;
      flex: 1;
    }

    .set-meta {
      color: #65676b;
      font-size: 0.9em;
      margin-bottom: 16px;
      padding-top: 12px;
      border-top: 1px solid #f0f2f5;
    }

    .set-item .actions { 
      display: flex;
      gap: 8px;
      margin: 0;
    }

    .btn-ghost {
      flex: 1;
      padding: 10px;
      background: white;
      color: #667eea;
      border: 2px solid #667eea;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      text-align: center;
      transition: all 0.3s;
    }

    .btn-ghost:hover {
      background: #667eea;
      color: white;
    }

    .btn-primary {
      flex: 1;
      padding: 10px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      text-align: center;
      transition: all 0.3s;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .empty-state {
      background: white;
      border-radius: 12px;
      padding: 60px 40px;
      text-align: center;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .empty-state h2 {
      font-size: 1.8em;
      color: #333;
      margin-bottom: 12px;
    }

    .empty-state p {
      color: #65676b;
      font-size: 1.1em;
    }

    .empty-state a {
      color: #667eea;
      font-weight: 600;
      text-decoration: none;
    }

    #noResults {
      background: white;
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      color: #65676b;
      display: none;
    }

    @media (max-width: 768px) {
      .container {
        padding: 0 12px;
      }
    }
  </style>
</head>
<body>
  {% set active_page = 'sets' %}
  {% include 'header.html' %}
  
  <div class="back-button-container">
    <button onclick="history.back()" class="back-button">
      <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13 8L5 16L13 24" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/><path d="M5 16H27C35 16 41 22 41 30C41 38 35 44 27 44H21" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>
      Quay l·∫°i
    </button>
  </div>
  
  <!-- Main Content -->
  <div class="container">
    <div class="page-header">
      <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
        <div>
          <h1><span class="iconify icon-collection icon-26 icon-gradient-accent" style="margin-right:8px;width:26px;height:26px;vertical-align:-6px;"></span>Danh s√°ch b·ªô t·ª´ v·ª±ng</h1>
          <p>T·ªïng h·ª£p t·∫•t c·∫£ b·ªô t·ª´ c·ªßa b·∫°n</p>
        </div>
        <div style="display: flex; gap: 12px;">
          <a href="/sets/create" class="btn" style="padding: 12px 24px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; font-weight: 600; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3); transition: all 0.3s;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            T·∫°o b·ªô t·ª´ m·ªõi
          </a>
          <a href="/upload" class="btn" style="padding: 12px 24px; background: #28a745; color: white; border: none; border-radius: 8px; font-weight: 600; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3); transition: all 0.3s;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            T·∫£i l√™n file
          </a>
        </div>
      </div>
    </div>
    
    <div class="search-box">
      <form class="search-form">
        <button type="button">
          <svg width="17" height="16" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="search">
            <path d="M7.667 12.667A5.333 5.333 0 107.667 2a5.333 5.333 0 000 10.667zM14.334 14l-2.9-2.9" stroke="currentColor" stroke-width="1.333" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
        </button>
        <input class="input" id="searchInput" placeholder="T√¨m ki·∫øm b·ªô t·ª´..." type="text" onkeyup="filterSets()">
        <button class="reset" type="button" onclick="document.getElementById('searchInput').value=''; filterSets();">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </form>
    </div>
    
    <!-- Tabs Navigation -->
    <div class="tabs-nav">
      <button class="tab-btn active" onclick="switchTab('my-sets', this)">
  <span class="iconify icon-folder icon-20 icon-gradient-accent"></span>
        <span>B·ªô t·ª´ c·ªßa t√¥i</span>
      </button>
      <button class="tab-btn" onclick="switchTab('saved-sets', this)">
  <span class="iconify icon-bookmark-filled icon-20 icon-gradient-accent"></span>
        <span>B·ªô t·ª´ ƒë√£ l∆∞u</span>
      </button>
    </div>
    
    <div class="actions">
  <a href="/" class="btn"><span class="iconify icon-upload icon-18 icon-gradient-accent" style="margin-right:6px;"></span>T·∫£i l√™n b·ªô t·ª´ m·ªõi</a>
  <a href="/browse" class="btn btn-browse"><span class="iconify icon-globe icon-18 icon-gradient-accent" style="margin-right:6px;"></span>Browse Community</a>
    </div>
    
    {% if sets %}
      <div id="setsList" class="sets-grid">
      {% for s in sets %}
      <div class="set-item" data-name="{{ s.name|lower }}" data-desc="{{ (s.description or '')|lower }}">
        <h3>{{ s.name }}</h3>
        <p class="set-description">{{ s.description or 'Kh√¥ng c√≥ m√¥ t·∫£' }}</p>
  <div class="set-meta"><span class="iconify icon-globe icon-16 icon-gradient-accent" style="margin-right:4px;"></span>{{ s.language_from }} ‚Üí {{ s.language_to }}</div>
        <div class="actions">
          <a href="/sets/{{ s.id }}" class="btn-ghost">Chi ti·∫øt</a>
          <a href="/study/{{ s.id }}?mode=select" class="btn-primary">H·ªçc ngay</a>
        </div>
      </div>
      {% endfor %}
      </div>
      <div id="noResults">
  <h2><span class="iconify icon-search icon-28 icon-gradient-accent" style="margin-right:6px;width:28px;height:28px;vertical-align:-6px;"></span>Kh√¥ng t√¨m th·∫•y</h2>
        <p>Kh√¥ng c√≥ b·ªô t·ª´ n√†o ph√π h·ª£p v·ªõi t√¨m ki·∫øm c·ªßa b·∫°n</p>
      </div>
    {% else %}
      <div class="empty-state">
  <h2><span class="iconify icon-collection icon-32 icon-gradient-accent" style="margin-right:6px;width:32px;height:32px;vertical-align:-6px;"></span>Ch∆∞a c√≥ b·ªô t·ª´ n√†o</h2>
        <p>H√£y <a href="/">t·∫£i l√™n file CSV/Excel</a> ƒë·ªÉ b·∫Øt ƒë·∫ßu h·ªçc!</p>
      </div>
    {% endif %}
  </div>
  
  <script>
    let currentTab = 'my-sets';
    let allSets = [];
    let savedSetIds = [];

    // Load bookmarked sets on page load
    async function loadBookmarkedSets() {
      try {
        const response = await fetch('/api/bookmarks');
        if (response.ok) {
          const data = await response.json();
          savedSetIds = data.bookmarks || [];
        }
      } catch (error) {
        console.error('Error loading bookmarks:', error);
      }
    }

    function switchTab(tab, button) {
      currentTab = tab;
      
      // Update button styles
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      button.classList.add('active');
      
      // Filter sets based on tab
      filterSetsByTab();
    }

    function filterSetsByTab() {
      const setsList = document.getElementById('setsList');
      if (!setsList) return;
      
      const items = setsList.getElementsByClassName('set-item');
      let visibleCount = 0;
      
      for (let i = 0; i < items.length; i++) {
        const setItem = items[i];
        const setId = setItem.querySelector('a[href^="/sets/"]').getAttribute('href').split('/')[2];
        const isBookmarked = savedSetIds.includes(setId);
        
        let shouldShow = false;
        if (currentTab === 'my-sets') {
          // Show all sets (assuming all listed sets are user's own)
          shouldShow = !isBookmarked; // Only show non-bookmarked sets as "my sets"
        } else if (currentTab === 'saved-sets') {
          shouldShow = isBookmarked;
        }
        
        if (shouldShow) {
          setItem.style.display = '';
          visibleCount++;
        } else {
          setItem.style.display = 'none';
        }
      }
      
      // Update no results message
      const noResults = document.getElementById('noResults');
      if (noResults) {
        if (visibleCount === 0 && items.length > 0) {
          noResults.style.display = 'block';
          if (currentTab === 'saved-sets') {
            noResults.innerHTML = '<h2>üîñ Ch∆∞a c√≥ b·ªô t·ª´ ƒë√£ l∆∞u</h2><p>B·∫°n ch∆∞a l∆∞u b·ªô t·ª´ n√†o. H√£y kh√°m ph√° v√† l∆∞u c√°c b·ªô t·ª´ y√™u th√≠ch!</p>';
          } else {
            noResults.innerHTML = '<h2>üìö Ch∆∞a c√≥ b·ªô t·ª´ n√†o</h2><p>H√£y t·∫°o b·ªô t·ª´ m·ªõi ƒë·ªÉ b·∫Øt ƒë·∫ßu h·ªçc!</p>';
          }
        } else {
          noResults.style.display = 'none';
        }
      }
      
      // Reapply search filter
      filterSets();
    }

    function filterSets() {
      const input = document.getElementById('searchInput');
      const filter = input.value.toLowerCase();
      const setsList = document.getElementById('setsList');
      const items = setsList ? setsList.getElementsByClassName('set-item') : [];
      const noResults = document.getElementById('noResults');
      
      let visibleCount = 0;
      
      for (let i = 0; i < items.length; i++) {
        // Skip if already hidden by tab filter
        if (items[i].style.display === 'none' && filter === '') continue;
        
        const name = items[i].getAttribute('data-name');
        const desc = items[i].getAttribute('data-desc');
        const setId = items[i].querySelector('a[href^="/sets/"]').getAttribute('href').split('/')[2];
        const isBookmarked = savedSetIds.includes(setId);
        
        // Check tab filter first
        let passTabFilter = false;
        if (currentTab === 'my-sets') {
          passTabFilter = !isBookmarked;
        } else {
          passTabFilter = isBookmarked;
        }
        
        // Then check search filter
        const passSearchFilter = name.indexOf(filter) > -1 || desc.indexOf(filter) > -1;
        
        if (passTabFilter && passSearchFilter) {
          items[i].style.display = '';
          visibleCount++;
        } else {
          items[i].style.display = 'none';
        }
      }
      
      if (noResults && filter) {
        noResults.style.display = (visibleCount === 0 && items.length > 0) ? 'block' : 'none';
        if (visibleCount === 0) {
          noResults.innerHTML = '<h2>üîç Kh√¥ng t√¨m th·∫•y</h2><p>Kh√¥ng c√≥ b·ªô t·ª´ n√†o ph√π h·ª£p v·ªõi t√¨m ki·∫øm c·ªßa b·∫°n</p>';
        }
      }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      loadBookmarkedSets().then(() => {
        // Show all sets by default (my-sets tab)
        filterSetsByTab();
      });
    });
  </script>
  <script src="{{ url_for('static', path='/enhanced.js') }}"></script>
  <script>
    // Initialize enhanced features for theme and toasts
    const themeManager = new ThemeManager();
    window.toast = new ToastNotification();
  </script>
</body>
</html>



