{# Reusable site header. Expects optional 'active_page' and 'username', 'user' in context #}
<div class="top-header">
  <div class="header-content">
    <a href="/" class="logo" style="display:flex;align-items:center;gap:10px;">
      <img src="{{ url_for('static', path='/logoicon.svg') }}" alt="VocabApp" class="logo-icon" />
    </a>
    <form class="search-form compact-search">
      <button type="button" aria-label="Tìm kiếm">
        <svg width="17" height="17" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="search">
          <path d="M7.667 12.667A5.333 5.333 0 107.667 2a5.333 5.333 0 000 10.667zM14.334 14l-2.9-2.9" stroke="currentColor" stroke-width="1.333" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
      </button>
      <input class="input" placeholder="Tìm kiếm bộ từ..." type="text">
      <button class="reset" type="reset" aria-label="Xóa" onclick="this.form.querySelector('.input').value=''; this.form.querySelector('.input').dispatchEvent(new Event('input'));">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </form>
    <div class="nav-icons">
      {% set ap = active_page if active_page is defined else '' %}
      <a href="/feed" class="nav-btn {% if ap=='feed' %}active{% endif %}" title="Feed">
        <img class="icon" src="{{ url_for('static', path='/icon_feed.svg') }}" alt="Feed" width="20" height="20"/>
        Feed
      </a>
      <a href="/sets" class="nav-btn {% if ap=='sets' %}active{% endif %}" title="Bộ từ của tôi">
        <img class="icon" src="{{ url_for('static', path='/icon_collection.svg') }}" alt="Bộ từ" width="20" height="20"/>
        Bộ từ
      </a>
      <a href="/dashboard" class="nav-btn {% if ap=='dashboard' %}active{% endif %}" title="Thống kê">
        <img class="icon" src="{{ url_for('static', path='/icon_chart.svg') }}" alt="Thống kê" width="20" height="20"/>
        Thống kê
      </a>
      <a href="/profile" class="nav-btn {% if ap=='profile' %}active{% endif %}" title="Hồ sơ">
        <img class="icon" src="{{ url_for('static', path='/icon_account.svg') }}" alt="Tài khoản" width="20" height="20"/>
        Tài khoản
      </a>
      <a href="/settings" class="nav-btn settings-link {% if ap=='settings' %}active{% endif %}" title="Cài đặt">
        <img class="icon" src="{{ url_for('static', path='/icon_settings.svg') }}" alt="Cài đặt" width="20" height="20"/>
        <span class="label">Cài đặt</span>
      </a>
      <a href="/user/{{ username }}" class="user-avatar-link" title="Trang cá nhân - {{ user.display_name or username }}">
        {% if user and user.avatar %}
          <img src="{{ user.avatar }}" class="user-avatar-img" alt="{{ user.display_name or username }}" />
        {% else %}
          <div class="user-avatar">{{ username[0].upper() }}</div>
        {% endif %}
      </a>
      <a href="/logout" class="nav-btn logout" title="Đăng xuất">Đăng xuất</a>
    </div>
  </div>
</div>
